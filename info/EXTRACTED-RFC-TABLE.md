

<h1 align="center">Extracted ICAP RFC table</h1>





| Section                                                      | Specification                                                | Implemented | RFC Page X |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ----------- | ---------- |
| 4.1 General Operation                                        | **ICAP** uses **TCP/IP** as a transport protocol.            | yes         | 11         |
| 4.1 General Operation                                        | The default port is **1344**, but other ports may be used.   | yes         | 11         |
| 4.1 General Operation                                        | Requests and responses use the generic message format of [RFC 2822](https://datatracker.ietf.org/doc/html/rfc2822) [3](https://datatracker.ietf.org/doc/html/rfc3507#ref-3) -- that is, a start-line (either a   request line or a status line), a number of header fields (also known   as "headers"), an empty line (i.e., a line with nothing preceding the **CRLF**) indicating the end of the header fields, and a message-body. |             | 11         |
| 4.1 General Operation                                        | The header lines of an **ICAP** message specify the **ICAP** resource being requested. |             | 11         |
| 4.1 General Operation                                        | A single transport connection MAY (perhaps even **SHOULD**) be re-used for multiple request/response pairs. |             | 11         |
| 4.1 General Operation                                        | Requests are matched up with responses by allowing only one outstanding request on a transport connection at a time. |             | 11         |
| 4.1 General Operation                                        | Multiple parallel connections MAY be used as in **HTTP**.    |             | 11         |
| 4.2 ICAP URI                                                 | If the port is empty or not given, port **1344** is assumed. |             | 11         |
| 4.2 ICAP URI                                                 | Any arguments that an **ICAP** client wishes to pass to an **ICAP** service to modify the nature of the service **MAY** be passed as part of the **ICAP-URI**, using the standard "**?**", **example**: "icap://icap.net/service?mode=translate&lang=french". |             | 11         |
| 4.3 ICAP Headers                                             | User-defined header extensions are allowed. all user-defined headers **MUST** follow the **"X-"** naming convention **("X-Extension-Header: Foo")**,**ICAP** implementations MAY ignore any **"X-"** headers without loss of compliance with the protocol as defined in this document. |             | 12         |
| 4.3 ICAP Headers                                             | Each header field consists of a name followed by a colon ("**:**") and the field value, Field names are case-insensitive. |             | 12         |
| 4.3.1 Headers Common to Requests and Responses               | The headers of all **ICAP** messages MAY include the following directives: (Cache-Control, Connection, Date, Expires, Pragma, Trailer, Upgrade). |             | 12         |
| 4.3.1 Headers Common to Requests and Responses               | "Transfer-Encoding" option is not allowed.                   |             | 12         |
| 4.3.1 Headers Common to Requests and Responses               | The Upgrade header MAY be used to negotiate Transport-Layer Security on an **ICAP** connection. |             | 12         |
| 4.3.2 Request Headers                                        | **ICAP** requests **MUST** start with a request line that contains a method, the complete **URI** of the **ICAP** resource being requested, and an **ICAP** version string, The current version number of **ICAP** is "**1.0**". |             | 13         |
| 4.3.2 Request Headers                                        | This version of ICAP defines three methods: (**REQMOD**  - for Request Modification, **RESPMOD** - for Response Modification, **OPTIONS** - to learn about configuration). |             | 13         |
| 4.3.2 Request Headers                                        | The **OPTIONS** method **MUST** be implemented by all **ICAP** servers, All other methods are optional and **MAY** be implemented. |             | 13         |
| 4.3.2 Request Headers                                        | User-defined extension methods are allowed. Before attempting to use   an extension method, an **ICAP** client **SHOULD** use the **OPTIONS** method to query the **ICAP** server's list of supported methods. |             | 13         |
| 4.3.2 Request Headers                                        | If an **ICAP** server receives a request for an unknown method, it **MUST** give a **501** error response. |             | 13         |
| 4.3.2 Request Headers                                        | Request specific headers are alllowed in **ICAP**: Authorization, Allow, From, Host (REQUIRED in ICAP as it is in HTTP/1.1), Referer, User-Agent. |             | 13         |
| 4.3.2 Request Headers                                        | Request headers unique to **ICAP** defined: Preview          |             | 13         |
| 4.3.3 Response Headers                                       | **ICAP** responses MUST start with an **ICAP** status line, similar in form   to that used by **HTTP**, including the **ICAP** version and a status code.                                                                                                                    For example: **ICAP/1.0 200 OK** |             | 14         |
| 4.3.3 Response Headers                                       | Semantics of **ICAP** status codes in **ICAP** match the status codes definedby **HTTP**.<br />**ICAP** error codes that differ from their HTTP counterparts are: <br />**100** - Continue after ICAP Preview.<br />**204** - No modifications needed.<br />**400** - Bad request.<br />**404** - ICAP Service not found.<br />**405** - Method not allowed for service (e.g., **RESPMOD** requested for service that supports only **REQMOD**).<br />**408** - Request timeout. **ICAP** server gave up waiting for a request from an ICAP client.<br />**500** - Server error.  Error on the **ICAP** server, such as "out of disk space".<br />**501** - Method not implemented. This response is illegal for an **OPTIONS** request since implementation of **OPTIONS** is mandatory.<br />**502** - Bad Gateway. This is an ICAP proxy and proxying produced an error.<br />**503** - Service overloaded.  The ICAP server has exceeded a maximum  connection limit associated with this service; the ICAP client should not exceed this limit in the future. |             | 14         |
| 4.3.3 Response Headers                                       | **ICAP**'s response-header fields allow the server to pass additional information in the response that cannot be placed in the **ICAP**'s status line. |             | 14         |
| 4.3.3 Response Headers                                       | A response-specific header is allowed in **ICAP** requests, following the same semantics as the corresponding **HTTP** response headers. This is: Server. |             | 14         |
| 4.3.3 Response Headers                                       | In addition to **HTTP-like** headers, there is also a response header unique to **ICAP** defined: **ISTag**. |             | 14         |
| 4..5 Message Preview                                         | **ICAP** servers **SHOULD** use the **OPTIONS** method to specify how many bytes of preview are needed for a particular **ICAP** application on a per-resource basis. Clients **SHOULD** be able to provide Previews of at least **4096** bytes. Clients furthermore **SHOULD** provide a Preview when using any **ICAP** resource that has indicated a Preview is useful. (This indication might be provided via the **OPTIONS** method, or some other "out-of-band" configuration.) Clients **SHOULD NOT** provide a larger Preview than a server has indicated it is willing to accept. |             | 18         |
| 4..5 Message Preview                                         | To effect a Preview, an **ICAP** client **MUST** add a "**Preview:**" header to its request headers indicating the length of the preview. client then sends:<br />- all of the encapsulated header sections.<br />- the beginning of the encapsulated body section, if any, up to the number of bytes advertised in the Preview (**possibly 0**). |             | 18         |
| 4..5 Message Preview                                         | After the Preview is sent, the client stops and waits for ani ntermediate response from the **ICAP** server before continuing. This mechanism is similar to the "**100-Continue**" feature found in **HTTP**, except that the stop-and-wait point can be within the message body. In contrast, **HTTP** requires that the point must be the boundary   between the headers and body. |             | 18         |
| 4..5 Message Preview                                         | After sending the preview, the **ICAP** client will wait for a response from the **ICAP** server. The response **MUST** be one of the following:<br /><br />-  **204 No Content.** <br />The ICAP server does not want to (or can not) modify the ICAP client's request. The ICAP client MUST treat this the same as if it had sent the entire message to the ICAP server and an identical message was returned.<br /><br />**ICAP** reqmod or respmod response, depending what method was the original request.<br /><br />**100 Continue.** <br />If the entire encapsulated **HTTP** body did not fit in the preview, the **ICAP** client **MUST** send the remainder of its **ICAP** message, starting from the first chunk after the preview.  If the entire message fit in the preview (detected by the "**EOF**"  symbol explained below), then the **ICAP** server **MUST NOT **respond with **100 Continue**. |             | 18         |
| 4.6 "204 No Content" Responses outside of Previews           | An **ICAP** client **MAY** include "**Allow: 204**" in its request headers, indicating that the server **MAY** reply to the message with a "**204 No Content**" response if the object does not need modification. An **ICAP** client **MAY** choose to honor "**204 No Content**" responses for an   entire message. This is the decision of the client because it imposes a burden on the client of buffering the entire message. |             | 22         |
| 4.6 "204 No Content" Responses outside of Previews           | If an **ICAP** server receives a request that does not have "**Allow: 204**", it **MUST NOT** reply with a **204**. In this case, an **ICAP** server **MUST** return the entire message back to the client, even though it is identical to the message it received. |             | 22         |
| 4.6 "204 No Content" Responses outside of Previews           | In case of message preview an **ICAP** server can respond with a **204 No Content** message in response to a   message preview **EVEN** if the original request did not have the "**Allow: 204**" header. |             | 22         |
| 4.7 ISTag Response Header                                    | It is a 32-byte-maximum alphanumeric string of data (not including the null character). |             | 22         |
| 4.7 ISTag Response Header                                    | An **ISTag** validates that previous **ICAP** server responses can still be considered fresh by an **ICAP** client that may be caching them. If a change on the **ICAP** server invalidates previous responses, the **ICAP** server can invalidate portions of the   ICAP client's cache by changing its **ISTag**. The **ISTag MUST** be included in every **ICAP** response from an **ICAP** server. |             | 22         |
| 4.7 ISTag Response Header                                    | An **ISTag** validates all entities generated by a particular service (**URI**).  A change in the **ISTag** invalidates all the other entities provided a service with the old **ISTag**, not just the entity whose response contained the updated **ISTag**. |             | 22         |
| 4.7 ISTag Response Header                                    | The syntax of an **ISTag** is simply:<br />   ISTag = "ISTag: " quoted-string<br />For example: <br />   ISTag: "874900-1994-1c02798" |             | 22         |
| 4.8.1 Request                                                | In **REQMOD** mode, the **ICAP** request **MUST** contain an encapsulated **HTTP** request. The headers and body (**if any**) **MUST** both be encapsulated, except that hop-by-hop headers are not encapsulated. |             | 23         |
| 4.8.2 Response                                               | The response from the **ICAP** server back to the **ICAP** client may take   one of four forms: <br />- An error indication,<br />- A **204** indicating that the **ICAP** client's request requires no adaptation.<br />- An encapsulated, adapted version of the **ICAP** client's request<br />-  An encapsulated **HTTP** error response. Note that Request Modification requests may only be satisfied with **HTTP** responses incases when the **HTTP** response is an error (e.g., **403 Forbidden**). |             | 24         |
| 4.9 Response Modification Mode                               | An ICAP client sends an   origin server's **HTTP** response to an ICAP server, and (if available)   the original client request that caused that response. |             | 27         |
| 4.9.1 Request                                                | the header and body of the **HTTP** response to be modified **MUST** be included in the ICAP body.   If available, the header of the original client request **SHOULD** also be included. As with the other method, the hop-by-hop headers of the encapsulated messages **MUST NOT** be forwarded. The Encapsulated header **MUST** indicate the byte-offsets of the beginning of each of these fou parts. |             | 27         |
| 4.9.2 Response                                               | The response from the **ICAP** server looks just like a reply in the Request Modification method, that is:<br />An error indication, An encapsulated and potentially modified **HTTP** response header and response body, or An **HTTP** response 204 indicating that the **ICAP** client's request requires no adaptation. |             | 27         |
| 4.9.2 Response                                               | If the return code is a **2XX**, the **ICAP** client **SHOULD** continue its normal execution of the response. The   **ICAP** client **MAY** re-examine the headers in the response's message headers in order to make further decisions about the response (e.g.,   its cachability). |             | 27         |
| 4.10 OPTIONS Method                                          | The **ICAP** "**OPTIONS**" method is used by the **ICAP** client to retrieve configuration information from the **ICAP** server.  In this method, the **ICAP** client sends a request addressed to a specific **ICAP** resource and receives back a response with options that are specific to the service named by the **URI**.  All **OPTIONS** requests **MAY** also return   options that are global to the server (i.e., apply to all services). |             | 29         |
| 4.10.1 OPTIONS Request                                       | The **OPTIONS** method consists of a request-line  such as the following example:<br />OPTIONS icap://icap.server.net/sample-service ICAP/1.0 User-Agent: ICAP-client-XYZ/1.001 |             | 29         |
| 4.10.2 OPTIONS Response                                      | OPTIONS icap://icap.server.net/sample-service ICAP/1.0 User-Agent: ICAP-client-XYZ/1.001The **OPTIONS** response consists of a status line followed by a series of header field **names-value** pairs   optionally followed by an **opt-body**. Multiple values in the value field **MUST** be separated by commas. If an opt-body is present in the **OPTIONS** response, the **Opt-body-type** header describes the format of the **opt-body**. |             | 30         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Methods:<br />The method that is supported by this service.  This header MUST be included in the OPTIONS response.  The **OPTIONS** method **MUST NOT** be in the Methods' list since it **MUST** be supported by all the **ICAP**      server implementations. Each service should have a distinct URI and support only one method in addition to **OPTIONS** For example:  <br /> Methods: RESPMOD |             | 30         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br /> - Service:<br />A text description of the vendor and product name. This header **MAY** be included in the **OPTIONS** response. For example:      <br />Service: XYZ Technology Server 1.0 |             | 30         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Encapsulated:<br />For example: <br />Encapsulated: opt-body=0 |             | 30         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Opt-body-type:<br />A token identifying the format of the opt-body.  (Valid opt-body types are not defined by ICAP.) This header MUST be included in the **OPTIONS** response **ONLY** if an opt-body type is present. For example:      <br />Opt-body-type: XML-Policy-Table-1.0 |             | 31         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Max-Connections:<br />The maximum number of **ICAP** connections the server is able to support. This header **MAY** be included in the **OPTIONS** response. For example:<br />Max-Connections: 1500 |             | 31         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Options-TTL:<br />The time (in seconds) for which this **OPTIONS** response is valid. If none is specified, the **OPTIONS** response does not expire. This header **MAY** be included in the OPTIONS response. The **ICAP** client      MAY reissue an **OPTIONS** request once the **Options-TTL** expires. For example:<br />Options-TTL: 3600Options-TTL: |             | 31         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Date: <br />The server's clock, specified as an RFC 1123 compliant date/time string. This header MAY be included in the **OPTIONS** response. For example: <br />Date: Fri, 15 Jun 2001 04:33:55 GMT |             | 31         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Service-ID:<br /> A short label identifying the ICAP service. It **MAY** be used in attribute header names. This header MAY be included in the **OPTIONS** response. For example:<br />Service-ID: xyztech |             | 31         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Allow:<br />A directive declaring a list of optional ICAP features that this server has implemented. This header **MAY** be included in the **OPTIONS** response. In this document we define the value "204" to indicate that the ICAP server supports a 204 response. For example:      <br />Allow: 204 |             | 32         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Preview:<br />The number of bytes to be sent by the ICAP client during a preview. This header **MAY** be included in the **OPTIONS** response. For example:      <br />Preview: 1024 |             | 32         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Transfer-Preview:<br />A list of file extensions that should be previewed to the **ICAP** server before sending them in their entirety.  This header **MAY** be included in the **OPTIONS** response. Multiple file extensions values should be separated by commas. The wildcard value "*****" specifies the default behavior for all the file extensions not specified inany other **Transfer-*** header (see below). For example:     <br />Transfer-Preview: * | A           | 32         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Transfer-Ignore:<br />A list of file extensions that should **NOT** be sent to the **ICAP** server. This header **MAY** be included in the **OPTIONS** response. Multiple file extensions should be separated by commas. For example: <br />Transfer-Ignore: html |             | 32         |
| 4.10.2 OPTIONS Response                                      | An **OPTIONS** header supported in this version of the protocol:<br /><br />- Transfer-Complete:<br />A list of file extensions that should be sent in their entirety (without preview) to the ICAP server. This header **MAY** be included in the **OPTIONS** response.  Multiple file extensions values should be separated by commas. For example: <br />Transfer-Complete: asp, bat, exe, com, ole    <br /><br />Note: If any of **Transfer-*** are sent, exactly one of them MUST contain   the wildcard value "\*" to specify the default.  If no "Transfer-*" are sent, all responses will be sent in their entirety (without Preview). |             | 32         |
| 5. Caching                                                   | **ICAP** servers' responses **MAY** be cached by **ICAP** clients, just as any other surrogate might cache **HTTP** responses. |             | 33         |
| 5. Caching                                                   | In Request Modification mode, the **ICAP** server **MAY** include caching directives in the **ICAP** header section of the **ICAP** response (**NOT** in the encapsulated **HTTP** request of the **ICAP** message body). |             | 33         |
| 5. Caching                                                   | In Response Modification mode, the **ICAP** server **MAY** add or modify the **HTTP** caching directives located in the encapsulated **HTTP** response (**NOT** in the **ICAP** header section). |             | 33         |
| 5. Caching                                                   | Consequently, the **ICAP** client **SHOULD** look for caching directives in the **ICAP** headers in case of **REQMOD**, and in the encapsulated **HTTP** response in case of **RESPMOD**. |             | 33         |
| 5. Caching                                                   | In cases where an **ICAP** server returns a modified version of an object created by an origin server, such as in Response Modification mode,   the expiration of the **ICAP-modified** object **MUST NOT** be longer than   that of the origin object. In other words, ICAP servers **MUST NOT** extend the lifetime of origin server objects, but **MAY** shorten it. |             | 33         |
| 5. Caching                                                   | In cases where the **ICAP** server is the authoritative source of an **ICAP** response, such as in Request Modification mode, the **ICAP** server is not restricted in its expiration policy. |             | 33         |
| 5. Caching                                                   | Note that the **ISTag** response-header may also be used to providing caching hints to clients. |             | 33         |
| 6.1 Vectoring points                                         | Adaptation of client requests. This is adaptation done every time a request arrives from a client. This is adaptation done when a request is "on its way into the cache". Factors such as the state of the objects currently cached will determine whether or not this request actually gets forwarded to an origin server (instead of, say, getting served off the cache's disk). |             | 34         |
| 6.1 Vectoring points                                         | Adaptation of requests on their way to an origin server. Although this type of adaptation is also an adaptation of       requests similar to (**i**), it describes requests that are "**on their way out of the cache**"; i.e., if a request actually requires tha an origin server be contacted. These adaptation requests are not necessarily specific to particular clients. An example would be addition of "**Accept:**"  headers for special devices; these adaptations can potentially apply to many clients. |             | 34         |
| 6.1 Vectoring points                                         | Adaptations of responses coming from an origin server. This is the adaptation of an object "**on its way into the cache**". In other words, this is adaptation that a surrogate might want to perform on an object before caching it.  The adapted object may subsequently served to many clients.  An example of this type of adaptation is virus checking: a surrogate will want to check an incoming origin reply for viruses once, before allowing it into the cache -- not every time the cached object is served to a client. |             | 34         |
| 6.2 Application Level Errors                                 | 1000 ICAP_CANT_CONNECT:  "Cannot connect to ICAP server".<br />The ICAP server is not connected on the socket.  Maybe the ICAP<br/>       server is dead or it is not connected on the socket. |             | 35         |
| 6.2 Application Level Errors                                 | 1001 ICAP_SERVER_RESPONSE_CLOSE: "ICAP Server closed connection while reading response".<br />The ICAP server TCP-shutdowns the connection before the ICAP<br/>       client can send all the body data |             | 35         |
| 6.2 Application Level Errors                                 | 1002 ICAP_SERVER_RESPONSE_RESET: "ICAP Server reset connection while reading response".<br />The ICAP server TCP-reset the connection before the ICAP client<br/>       can send all the body data. |             | 35         |
| 6.2 Application Level Errors                                 | 1003 ICAP_SERVER_UNKNOWN_CODE: "ICAP Server sent unknown response code".<br />An unknown ICAP response code (see Section 4.x) was received by<br/>       the ICAP client. |             | 35         |
| 6.2 Application Level Errors                                 | 1004 ICAP_SERVER_UNEXPECTED_CLOSE_204: "ICAP Server closed connection on 204 without 'Connection: close' header".<br />An ICAP server MUST send the "Connection: close" header if<br/>       intends to close after the current transaction. |             | 35         |
| 6.2 Application Level Errors                                 | 1005 ICAP_SERVER_UNEXPECTED_CLOSE: "ICAP Server closed connection as ICAP client wrote body<br/>       preview". |             | 35         |
| 6.3  Use of Chunked Transfer-Encoding                        | **ICAP** messages **MUST** use the "**chunked**" **transfer-encoding** within the encapsulated body section as defined in **HTTP/1.1**. This requires that **ICAP** client implementations convert incoming objects "**on the fly**" to chunked from whatever transfer-encoding on which they arrive. |             | 37         |
| 6.3  Use of Chunked Transfer-Encoding                        | For objects arriving using "**Content-Length**" headers, one big chunk can be created of the same size as indicated in the **Content-Length** header. |             | 37         |
| 6.3  Use of Chunked Transfer-Encoding                        | For objects arriving using a **TCP** close to signal the end of the object, each incoming group of bytes read from the **OS** can be converted into a chunk (by writing the length of the bytes read, followed by the bytes themselves) |             | 37         |
| 6.3  Use of Chunked Transfer-Encoding                        | For objects arriving using chunked encoding, they can be retransmitted as is (without re-chunking). |             | 37         |
| 7.1 Authentication                                           | WWW-Authenticate challenges and responses are for end-to-end authentication between a client (user) and an origin server. As any proxy, ICAP clients and ICAP servers MUST forward these headers without modification. |             | 37         |
| 7.1 Authentication                                           | If authentication is required between an ICAP client and ICAP server, hop-by-hop Proxy Authentication MUST be used. |             | 37         |
| 7.2 Encryption                                               | Users of ICAP should note well that ICAP messages are not encrypted for transit by default.  In the absence of some other form o encryption at the link or network layers, eavesdroppers may be able to record the unencrypted transactions between ICAP clients and servers. The Upgrade header MAY be used to negotiate transport-layer security for an ICAP connection. Note also that end-to-end encryption between a client and origin server is likely to preclude the use of value-added services by intermediaries such as surrogates. An ICAP server that is unable to   decrypt a client's messages will, of course, be unable to perform any transformations on it. |             | 38         |
| 7.3 Service Validation                                       | Normal HTTP surrogates, when operating correctly, should not affect the end-to-end semantics of messages that pass through them. This forms a well-defined criterion to validate that a surrogate is working correctly: a message should look the same before the surrogate as it does after the surrogate. In contrast, ICAP is meant to cause changes in the semantics of messages on their way from origin servers to users. The criteria for a correctly operating surrogate are no longer as easy to define.This will make validation of ICAP services significantly more   difficult. Incorrect adaptations may lead to security vulnerabilities that were not present in the unadapted content. |             | 38         |
| 8.2 Mandatory Use of Chunking                                | Chunking is mandatory in ICAP encapsulated bodies he chunked encoding allows boththe client and server to keep the transport-layer connection open for later reuse. |             | 39         |
| 8.2 Mandatory Use of Chunking                                | ICAP servers (and their developers) should be encouraged to produce "incremental" responses where possible, By standardizing on a single encapsulation mechanism, we avoid the complexity that would be required in client and server software to support multiple mechanisms. |             | 39         |
| 8.2 Mandatory Use of Chunking                                | While chunking of encapsulated bodies is mandatory, encapsulated headers are not chunked. |             | 39         |
| 8.3 Use of the null-body directive in the Encapsulated header | parsers do not know in advance how much header data is coming (e.g., for buffer allocation). ICAP does not allow chunking in the header part. To compensate, the "null-body" directive allows the final header's length to be   determined, despite it not being chunked. |             | 40         |
